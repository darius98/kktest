language: cpp

matrix:
  include:
    - os: linux
      env: COMPILER=g++-5 BUILD_TYPE=Debug
      addons: &gcc5
        apt:
          packages:
            - g++-5
          sources:
            - ubuntu-toolchain-r-test

    - os: linux
      env: COMPILER=g++-5 BUILD_TYPE=Release
      addons: *gcc5


    - os: linux
      env: COMPILER=g++-7 BUILD_TYPE=Debug
      addons: &gcc7
        apt:
          packages:
            - g++-7
          sources:
            - ubuntu-toolchain-r-test

    - os: linux
      env: COMPILER=g++-7 BUILD_TYPE=Release
      addons: *gcc7

    - os: osx
      env: COMPILER=clang++ BUILD_TYPE=Release

    - os: osx
      env: COMPILER=clang++ BUILD_TYPE=Debug

script:
  - export CXX=${COMPILER}
  - cmake CMakeLists.txt -DCMAKE_BUILD_TYPE=${BUILD_TYPE}
  - make common_interproc_test -j2
  - make common_utils_test -j2
  - make common_string_test -j2
  - make kktest_extension_core_matchers_test -j2
  - ./build/tests/common_interproc_test
  - ./build/tests/common_interproc_test -b
  - ./build/tests/common_string_test
  - ./build/tests/common_string_test -b
  - ./build/tests/common_utils_test
  - ./build/tests/common_utils_test -b
  - ./build/tests/kktest_extension_core_matchers_test
  - ./build/tests/kktest_extension_core_matchers_test -b
