#define VERSION "1.0.0"

#include <iostream>

#include <kktest_impl/main.hpp>
#include <kktest_impl/signature.hpp>

#include <kktest_ext/feedback.hpp>

using namespace kktest;
using namespace cppli;
using namespace std;

int main(int argc, char** argv) {
    Cppli cppli("Test binary. Generated by The KKTest Framework.");
    cppli.addHelpFlag();
    cppli.addTerminalFlag(
        FlagSpec("version")
        .setShortName("v")
        .setDescription("Display program version."),
        "KKTest generated test-case.\nKKTest version: " VERSION "\n");
    cppli.addTerminalFlag(FlagSpec("get-signature")
                          .setDescription("Display the KKTest 32-byte "
                                          "signature in hexadecimal format"),
                          string(kkTestSignatureHex) + "\n");

    kktest::feedback::FeedbackExtension feedbackExtension;
    feedbackExtension.registerCommandLineArgs(&cppli);

    InternalArgs internalArgs = registerInternalFlags(&cppli);

    cppli.interpret(argc, argv);

    return kktest::main({
        &feedbackExtension
    }, internalArgs);
}
